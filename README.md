# "Unwanted Virus"

## Principal Information

**This program has been created by experimenting purposes, this has not the intention to be viral, the "VIRUS" in the name is just a name, it won't became viral**

Be consent about you are downloading, this malicious software (commonly called malware), **I won't be responsible if your (or any other) machine dies by this malware**

My recomendation is **use a VIRTUAL MACHINE if you want to test this** and never, never, **NEVER send this to your friends or knowns (never)**

* **Passw√∂rd of the file:** "*J4d'X4D;y&2$SdM" (without quotes)

* **Size of the executable:** 252 KB

* **Versions of Windows tested:** Windows 7 to 11 (most tested in 10)

* **Admin rights required:** yes

## Payload

### 0** step:

![Windows 10 x64-2022-03-17-18-39-43](https://user-images.githubusercontent.com/82547281/158902621-5ae8e7f9-788e-43e6-a36c-e56131e8598f.png)

*(needs user consent)*

If user selects no, the next message shows up:

![Windows 10 x64-2022-03-17-18-39-49](https://user-images.githubusercontent.com/82547281/158902838-aefd4278-86af-45bc-8d54-1c3fc19e8e3a.png)

*("Ok, you missed the fun")*


### 1st Step:

*First of all, it overwrites the MBR with a game, then the malware sets the time to 3:33:33 infinitely*

![Windows 10 x64-2022-03-17-18-53-21](https://user-images.githubusercontent.com/82547281/158903049-c9e523aa-41b0-478e-8d84-835b4f794269.png)

*It disables everything that every malware disables: CMD, taskmgr, etc.*

*Then it infects some programs to run its own code with an infected message*

![Windows 10 x64-2022-03-17-18-51-25](https://user-images.githubusercontent.com/82547281/158903747-e1745439-64cd-4590-a661-81b63427452a.png)

*It also infects the Logon User Interface (LogonUI.exe) for making not working when E.G. you press CTRL+ALT+DEL*

![Windows 10 x64-2022-03-17-18-51-40](https://user-images.githubusercontent.com/82547281/158903990-efacddc8-308a-452c-b8a9-076863b72351.png)

*Or if you (find out the way for) log off you cannot Log-In anymore*

![Windows 10 x64-2022-03-17-18-51-57](https://user-images.githubusercontent.com/82547281/158904285-241c92da-cb7c-40c5-8261-49a388ec9fea.png)

*And yes, your user account was deleted so you cannot recover it anymore*

*Maybe your files yes but your account not*

*It also infects programs like MS-SETTINGS (UWP) and RunDLL32 which some settings cannot be changed*

### 2nd Step:

*It starts to download from the Internet some files that in the 3rd step will be shown (Like the Wordpad, the Paint, the Background) except the notes that it will written by the program itself*

*There's nothing more to show, since it happens at the background so we see like everything is normal except the time*

### 3rd Step:

*After downloading everything (see 2nd Step) it follows the next steps**

* **It changes the Background**

![Windows 10 x64-2022-03-17-18-34-19](https://user-images.githubusercontent.com/82547281/158906078-e193dd11-1b93-42db-ac9a-4540c754161a.png)

* **It creates random files on your desktop**

![Windows 10 x64-2022-03-17-18-34-40](https://user-images.githubusercontent.com/82547281/158906151-cc6f3ccb-09cf-40d2-85ee-33e5d3d8c7bf.png)


* **It open a note "...you ran the Unwanted Virus..."**

* **Starts doing a screen effect**

* **Starts a (kind of) scary music**

* **Starts to pop-up random messages**

* **It opens a Wordpad Document**

* **It opens a Paint drawing with (I think) cute kittens**

![Windows 10 x64-2022-03-17-18-36-33](https://user-images.githubusercontent.com/82547281/158906180-b73ec0ed-dc6b-444d-8c3d-15c191f0672e.png)

* **It opens notepads with Random messages**

* **Open a Final Note ("10 seconds left")**

*After (approximately) 10 or 15 seconds the computer dies with a blue screen of death with a 0x0000029A code*

![Windows 10 x64-2022-03-17-18-37-06](https://user-images.githubusercontent.com/82547281/158906218-df7bb359-c203-4585-a98a-70b1b5c28c50.png)

*Then **Since the MBR has been overwritten** it will load the game:*
(that is Space Invaders by "nanochess" https://github.com/nanochess/Invaders)

![image](https://user-images.githubusercontent.com/82547281/158906678-b3997969-9b3a-43c2-be3c-d6f02cb4af9b.png)


## Curiosities
### Rare right-click items

*If you right click something you can see rare items in the menu:*

![Windows 10 x64-2022-03-17-18-33-45](https://user-images.githubusercontent.com/82547281/158907037-8a272265-6b96-491d-b330-3fc42be11110.png)

*If you click one of those items, your computer will die instantly*

![Windows 10 x64-2022-03-17-18-40-17](https://user-images.githubusercontent.com/82547281/158907161-43950701-9a32-41f7-9cea-bcb7fe91f3d1.png)

### "This is not a normal computer"

*This is a easter egg, if you delete winlogon.exe and then run the malware you got this message box, then your computer restarts*

![Windows 10 x64-2022-03-17-18-58-17](https://user-images.githubusercontent.com/82547281/158907451-4eba0218-d52f-486a-bf5c-efcb54958c21.png)

### "We cannot found the command interpreter"

*This easter egg can be found if you run the malware with* 'DisableCMD=1'
*This malware rarely uses cmd, this messagebox was programmed because it comes from a kind of legacy version (it used cmd for everything)*

![image](https://user-images.githubusercontent.com/82547281/158907799-aa27819c-8738-4b2d-9eb4-118934596e85.png)

### Internet disconnection

*If you disconnect the internet before you run the malware it will show the next message*

![Windows 10 x64-2022-03-17-18-42-04](https://user-images.githubusercontent.com/82547281/158908163-64d64e85-aa7b-41be-ae98-9610b85c33cf.png)

*(ERR_INTERNET_DISCONNECTED)*

*Then the computer dies with BSOD*

*if you disconnect after you run the malware the message will be different*

![Windows 10 x64-2022-03-17-18-44-00](https://user-images.githubusercontent.com/82547281/158908263-c1993ecb-a412-460f-b7f0-d8c03951bf8e.png)

*(UNKNOWN_HARD_ERROR)*

*Then the computer dies with BSOD*

*This happens because the malware checks the internet connection and then download the files, if there's no internet connection it throws the first error (ERR_INTERNET_CONNECTION), else if you disconnect while you are running the malware (downloading) it shows the last error shown (UNKNOWN_HARD_ERROR)*

## Bugs

### Rarely (at 3rd step) stops
A bug that I found (rarely happens) that the program stops at the 3rd step, I don't know why (maybe too much threads: I tried to add one and dies or PC specs idk) just i let it there if someone of you happens...  







